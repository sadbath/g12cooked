<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Am I Cooked? - A compilation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.8.0/dist/tf.min.js"></script>
  <style>
    .stretched-link::after {
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1; /* This pseudo-element will be the clickable overlay */
  pointer-events: auto;
  background-color: rgba(0,0,0,0); /* Can be transparent */
}
  </style>
</head>
<body class="bg-gray-50">

<!-- Increased max-width to accommodate sidebar -->
<div class="container mx-auto max-w-6xl p-4 sm:p-8">

  <!-- Main Grid Layout: 1 column on mobile, 3 columns on large screens -->
  <div class="grid grid-cols-1 lg:grid-cols-3 lg:gap-8">

    <!-- == Main Content Column (takes 2 of 3 columns on lg screens) == -->
    <main class="lg:col-span-2">
      <!-- Header -->
      <header class="mb-8 text-center lg:text-left">
        <h1 class="text-3xl font-bold text-gray-800">
          A Godforsaken List of Every "Am I Cooked" Post on r/OntarioGrade12s
        </h1>
        <p class="text-gray-500 mt-1">I want to smite myself every time I see one.</p>
      </header>

      <!-- List of Reddit Post Cards -->
      <div id="reddit-card-list" class="flex flex-col space-y-4">
        
        <!-- Loading State (Visible by default) -->
        <div id="loading-state">
          <div class="text-center text-gray-500 mb-4">
            <p class="font-semibold">Training AI model & fetching posts...</p>
            <p class="text-sm">This may take a moment.</p>
          </div>
          <!-- Skeleton Card 1 -->
          <div class="bg-white rounded-lg shadow-sm border border-gray-200 flex p-3 animate-pulse">
            <div class="flex flex-col items-center p-2 mr-2">
              <div class="w-5 h-5 bg-gray-200 rounded"></div> <div class="w-8 h-4 bg-gray-300 rounded my-2"></div> <div class="w-5 h-5 bg-gray-200 rounded"></div>
            </div>
            <div class="flex-grow space-y-2">
              <div class="h-4 bg-gray-300 rounded w-3/4"></div> <div class="h-6 bg-gray-200 rounded w-full"></div> <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
          </div>
          <!-- Skeleton Card 2 -->
          <div class="bg-white rounded-lg shadow-sm border border-gray-200 flex p-3 animate-pulse">
            <div class="flex flex-col items-center p-2 mr-2">
              <div class="w-5 h-5 bg-gray-200 rounded"></div> <div class="w-8 h-4 bg-gray-300 rounded my-2"></div> <div class="w-5 h-5 bg-gray-200 rounded"></div>
            </div>
            <div class="flex-grow space-y-2">
              <div class="h-4 bg-gray-300 rounded w-3/4"></div> <div class="h-6 bg-gray-200 rounded w-full"></div> <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
          </div>
        </div>
        
        <!-- "No Posts Found" message (Hidden by default) -->
        <div id="no-posts-found" class="hidden text-center text-gray-500 py-8">
          <h3 class="text-lg font-semibold">No "cooked" posts found.</h3>
          <p>Looks like everyone is feeling confident for once!</p>
        </div>
      </div>
    </main>

    <!-- == Sidebar Column (takes 1 of 3 columns on lg screens) == -->
    <aside class="mt-12 lg:mt-0">
      <!-- The sticky container makes it stay in view on scroll (on desktop) -->
      <div class="sticky top-8">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
          <h3 class="text-lg font-bold text-gray-800 mb-4">(actually helpful things)</h3>
          
          <ul class="space-y-2">
            <!-- Link 1: Ouknow -->
            <li>
              <a href="https://ouknow.vercel.app" class="flex items-start p-3 -mx-3 rounded-lg hover:bg-gray-100 transition-colors">
                <div class="flex-shrink-0 h-10 w-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mr-4">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
                </div>
                <div>
                  <p class="font-semibold text-gray-800">Ouknow</p>
                  <p class="text-sm text-gray-500">Find easy-to-read info about any university program in Ontario.</p>
                </div>
              </a>
            </li>

            <!-- Link 2: Stuedu Resources -->
            <li>
              <a href="https://stuedu.vercel.app" class="flex items-start p-3 -mx-3 rounded-lg hover:bg-gray-100 transition-colors">
                <div class="flex-shrink-0 h-10 w-10 bg-green-100 text-green-600 rounded-full flex items-center justify-center mr-4">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" /></svg>
                </div>
                <div>
                  <p class="font-semibold text-gray-800">Stuedu Resources</p>
                  <p class="text-sm text-gray-500">Notes, videos, and channels to help with any high school subject.</p>
                </div>
              </a>
            </li>

            <!-- Link 3: CareerToUni -->
            <li>
              <a href="https://careertouni.vercel.app" class="flex items-start p-3 -mx-3 rounded-lg hover:bg-gray-100 transition-colors">
                <div class="flex-shrink-0 h-10 w-10 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center mr-4">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m-6 10v-5m6 5v-5m0 0l-6-3m6 3V7" /></svg>
                </div>
                <div>
                  <p class="font-semibold text-gray-800">CareerToUni</p>
                  <p class="text-sm text-gray-500">Find pathways to any career through any university program.</p>
                </div>
              </a>
            </li>

          </ul>
        </div>
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mt-4">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Enjoying This?</h3>
    
    <div class="flex flex-col space-y-3">

      <!-- Primary CTA Button -->
      <a href="https://ko-fi.com/M4M41JEW6P" class="w-full bg-blue-600 text-white font-bold py-2.5 px-4 rounded-lg flex items-center justify-center space-x-2 hover:bg-blue-700 transition-colors duration-200">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cup" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M.11 3.187A.5.5 0 0 1 .5 3h13a.5.5 0 0 1 .488.608l-.22.991a3.001 3.001 0 0 1-1.3 5.854l-.132.59A2.5 2.5 0 0 1 9.896 13H4.104a2.5 2.5 0 0 1-2.44-1.958L.012 3.608a.5.5 0 0 1 .098-.42Zm12.574 6.288a2 2 0 0 0 .866-3.899zM1.124 4l1.516 6.825A1.5 1.5 0 0 0 4.104 12h5.792a1.5 1.5 0 0 0 1.464-1.175L12.877 4H1.123Z"/>
</svg><span>Buy me a coffee</span>
      </a>

      <!-- Secondary Link -->
      <a href="https://nowpayments.io/donation?api_key=26c0f2a9-a3f5-4f11-adbd-bd5cd0b5c9b6" class="w-full text-center text-sm font-medium text-gray-600 hover:text-gray-900 hover:underline">
        or donate with Crypto
      </a>
      
    </div>
  </div>     
    </aside>

  </div>
</div>

<!-- YOUR JAVASCRIPT REMAINS EXACTLY THE SAME -->
<script>
  // --- All of your previous JavaScript code goes here ---
  // --- No changes are needed to the script. ---

  function tokenize(text, vocab) { /* ... unchanged ... */ return text.toLowerCase().split(/\W+/).filter(Boolean).map(word => vocab[word] || 0); }
  function padSequence(seq, maxLen) { /* ... unchanged ... */ if (seq.length > maxLen) return seq.slice(0, maxLen); while (seq.length < maxLen) seq.push(0); return seq; }
  function buildVocab(texts) { /* ... unchanged ... */ const vocab = {}; let idx = 1; texts.forEach(text => { text.toLowerCase().split(/\W+/).filter(Boolean).forEach(word => { if (!vocab[word]) vocab[word] = idx++; }); }); return vocab; }
  
  const trainingPosts = ["Am I cooked because of my grade 11 marks?", "Worried about my grade 11 grades affecting university", "Whatâ€™s the weather today?", "Looking for advice on grade 11 marks and university", "How to bake a cake?", "Is my poor grade 11 mark going to ruin my chances?"];
  const labels = [1, 1, 0, 1, 0, 1];
  const maxLen = 10;
  const vocab = buildVocab(trainingPosts);
  const xs = trainingPosts.map(t => padSequence(tokenize(t, vocab), maxLen));
  const ys = tf.tensor(labels);
  const xsTensor = tf.tensor2d(xs, [xs.length, maxLen]);
  const model = tf.sequential();
  model.add(tf.layers.embedding({ inputDim: Object.keys(vocab).length + 1, outputDim: 8, inputLength: maxLen }));
  model.add(tf.layers.flatten());
  model.add(tf.layers.dense({ units: 8, activation: 'relu' }));
  model.add(tf.layers.dense({ units: 1, activation: 'sigmoid' }));
  model.compile({ optimizer: 'adam', loss: 'binaryCrossentropy', metrics: ['accuracy'] });

  async function trainAndShow() {
    const cardList = document.getElementById('reddit-card-list');
    const loadingState = document.getElementById('loading-state');
    const noPostsState = document.getElementById('no-posts-found');
    
    await model.fit(xsTensor, ys, { epochs: 50, shuffle: true });

    const posts = await fetchRedditPosts("OntarioGrade12s");
    let postsFound = 0;

    cardList.innerHTML = ''; 

    for (const post of posts) {
      const seq = padSequence(tokenize(post.title, vocab), maxLen);
      const input = tf.tensor2d([seq], [1, maxLen]);
      const pred = (await model.predict(input).data())[0];
      
      if (pred > 0.5) {
        postsFound++;
        addRedditCard(post, cardList);
      }
      input.dispose();
    }
    
    if (postsFound === 0) {
      noPostsState.classList.remove('hidden');
      cardList.appendChild(noPostsState);
    }
  }

  async function fetchRedditPosts(subreddit) {
    try {
      const response = await fetch(`https://corsproxy.io/?url=https://www.reddit.com/r/${subreddit}/search.json?q=cooked&type=link&t=month&restrict_sr=1`);
      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
      const data = await response.json();
      return data.data.children.map(post => ({
        subredditIcon: post.data.sr_detail?.icon_img || 'https://corsproxy.io/?url=https://www.redditstatic.com/avatars/avatar_default_02_46A508.png',
        subredditName: post.data.subreddit,
        poster: post.data.author,
        postTime: new Date(post.data.created_utc * 1000).toLocaleString(),
        upvotes: post.data.ups,
        title: post.data.title,
        commentsCount: post.data.num_comments,
        link: `https://www.reddit.com${post.data.permalink}`
      }));
    } catch (e) {
      console.error("Failed to fetch posts:", e);
      return [];
    }
  }

  function addRedditCard(post, container) {
    const card = document.createElement('div');
    card.className = 'bg-white rounded-lg shadow-sm border border-gray-200 flex p-3 hover:border-gray-400 transition-all duration-200';
    
    card.innerHTML = `
      <div class="flex flex-col items-center justify-start p-2 mr-2">
        <button aria-label="Upvote"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500 hover:text-orange-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg></button>
        <span class="text-sm font-bold my-1 text-gray-800">${post.upvotes}</span>
        <button aria-label="Downvote"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500 hover:text-blue-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 10.293a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 111.414-1.414L9 14.586V3a1 1 0 112 0v11.586l4.293-4.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg></button>
      </div>
      <div class="flex-grow">
        <div class="text-xs text-gray-500 flex items-center space-x-2">
          <img src="${post.subredditIcon}" alt="Subreddit Icon" class="rounded-full w-5 h-5 bg-gray-200" />
          <span class="font-bold text-gray-800">r/${post.subredditName}</span>
          <span>â€¢ Posted by u/${post.poster}</span>
          <span>â€¢ ${post.postTime}</span>
        </div>
        <h2 class="text-lg font-semibold text-gray-900 mt-1">${post.title}</h2>
        <div class="flex items-center space-x-4 mt-3 text-xs font-bold text-gray-500">
          <a href="${post.link}" target="_blank" class="hover:bg-gray-100 p-1 rounded">${post.commentsCount} Comments</a>
          <a href="#" class="hover:bg-gray-100 p-1 rounded">Share</a>
          <a href="#" class="hover:bg-gray-100 p-1 rounded">Save</a>
        </div>
      </div>
    `;
    container.appendChild(card);
  }

  document.addEventListener("DOMContentLoaded", trainAndShow);
</script>

</body>
</html>
